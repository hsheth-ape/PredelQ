# Session Log: 2025-12-31-planning-002

> **Type:** Planning + Execution (Demoware)
> **Date:** 2025-12-31
> **Duration:** ~1 hour
> **Status:** Complete

---

## Session Goal

Build demoware database with mock data for Metabase dashboarding and client validation.

---

## What Was Built

### Schema (24 tables)
- **Master Data**: oems, asset_models, customers, accounts, assets, entity_identifiers
- **Transactions**: payments, repayment_schedule, delinquency_history
- **Raw Data**: raw_telemetry
- **Metric System**: metric_definitions, metric_values (with context JSONB)
- **Indicator System**: indicator_definitions, indicator_values (with context JSONB)
- **Event System**: event_definitions, events (with context JSONB)
- **Operational Snapshots**: asset_current_state, account_current_state, customer_current_state
- **POIs**: pois, poi_visit_patterns
- **Aggregates**: metric_aggregates

### Mock Data
- 15 accounts (5 healthy, 5 at-risk, 5 delinquent)
- 15 assets with telemetry patterns
- 63 payment records showing different behaviors
- 14 metric definitions, 37 metric values
- 6 indicator definitions, 15 indicator values
- 12 event definitions, 10 active events
- 15 POIs (bases, work locations, service centers)

### Metabase Views (8)
- v_portfolio_overview
- v_account_risk_dashboard
- v_asset_telemetry_dashboard
- v_open_events
- v_event_timeline
- v_indicator_trends
- v_poi_summary
- v_collection_priority

---

## Key Design Decisions

| Decision | Choice | Rationale |
|----------|--------|-----------|
| Context storage | JSONB field on values/events | Flexibility for human-readable messages |
| POI ownership | Multi-entity (asset, customer, oem) | Service centers, home addresses, detected bases |
| Current state | Separate snapshot tables per entity | Fast Metabase queries, clear update semantics |
| Views | Pre-joined for dashboarding | Metabase users don\'t need complex SQL |

---

## Architecture Refinements from Session

1. **Events need context**: Added indicator_from/to scores, metric comparisons, recommendations
2. **POIs are multi-entity**: Not just asset bases - customer homes, OEM service centers
3. **Current state at all levels**: Asset, account, AND customer snapshots
4. **JSONB for flexibility**: Context fields allow rich, human-readable messaging

---

## Files Created/Updated

| File | Action |
|------|--------|
| `CURRENT.md` | Updated with demoware status |
| `METABASE_GUIDE.md` | New - connection details and dashboard guide |
| `sessions/2025-12-31-planning-002.md` | This log |

---

## Next Steps

1. **Connect Metabase** to Supabase using credentials in METABASE_GUIDE.md
2. **Build demo dashboards** per suggested layouts
3. **Demo to client** for concept validation
4. **Sprint 1**: Real data ingestion (after validation)

---

## Promote to Project Docs

| Item | Target | Done |
|------|--------|------|
| Schema deployed | CURRENT.md | ✓ |
| Views documented | METABASE_GUIDE.md | ✓ |
| Credentials | CURRENT.md | ✓ |
